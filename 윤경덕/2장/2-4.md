### 목차

- [2.4 렌더링은 어떻게 일어나는가?](#24-렌더링은-어떻게-일어나는가)
  - [2.4.1 리액트의 렌더링이란?](#241-리액트의-렌더링이란)
  - [2.4.2 리액트에서의 렌더링이 일어나는 이유](#242-리액트에서의-렌더링이-일어나는-이유)
    - [최초 렌더링](#최초-렌더링)
    - [리렌더링](#리렌더링)
  - [2.4.3 리액트의 렌더링 프로세스](#243-리액트의-렌더링-프로세스)
    - [프로세스](#프로세스)
  - [2.4.4 렌더와 커밋](#244-렌더와-커밋)
    - [렌더 단계 (Render Phase)](#렌더-단계-render-phase)
    - [커밋 단계 (Commit Phase)](#커밋-단계-commit-phase)
  - [2.4.5 일반적인 렌더링 시나리오 살펴보기](#245-일반적인-렌더링-시나리오-살펴보기)

# 2.4 렌더링은 어떻게 일어나는가?

- React는 렌더링을 위한 자체적인 렌더링 프로세스가 존재한다.
- React의 렌더링은 시간과 리소스를 소비해 수행된다.
  - 이 모든것이 사용자에게 청구되는 개념이다.
  - 시간이 길어지고 복잡해질수록 사용자 경험을 저해한다.

## 2.4.1 리액트의 렌더링이란?

> 리액트에서의 렌더링이란 React Application 트리 안에 있는 모든 Component들이 props 와 state의 값을 기반으로 어떻게 UI를 구성하고 이를 바탕으로 어떤 DOM 결과를 브라우저에 제공할 것인지 계산하는 일련의 과정

## 2.4.2 리액트에서의 렌더링이 일어나는 이유

### 최초 렌더링

- 사용자가 처음 어플리케이션에 진입할때 표현하는 렌더링

### 리렌더링

- 최초 렌더링 이외의 모든 렌더링
- 클래스 컴포넌트
  1. 클래스 컴포넌트의 setState가 실행되는 경우
  2. 클래스 컴포넌트의 forceUpdate가 실행 되는 경우
- 함수 컴포넌트
  1. useState()의 setter 가 실행 되는 경우
  2. useReducer()의 dispatch 가 실행되는 경우
  3. 컴포넌트의 key props 가 변경 되는 경우
     - 같은 컴포넌트인지 구별하는 값 (current Tree, workInProgress Tree)
  4. props가 변경되는 경우
  5. 부모 컴포넌트가 렌더링될 경우
     - 부모 컴포넌트 렌더링 시, 무조건 자식 컴포넌트도 리렌더링 된다.

## 2.4.3 리액트의 렌더링 프로세스

### 프로세스

1. 리액트는 컴포넌트 root 에서 부터 트리의 아래쪽으로 내려간다.
2. 업데이트가 필요하다고 생각되는 컴포넌트를 발견한다.
   - 클래스 컴포넌트 : render() 함수를 실행
   - 함수 컴포넌트 : FunctionComponent() 자체 호출뒤 결과를 저장
3. 렌더링 결과물 수집
4. 가상 DOM 과 현재 DOM을 비교해 실제 DOM에 반영하기 위한 변경사항 수집
5. 모든 수집 종료
6. 모든 변경 사항을 실제 DOM에 적용한다.

- 리액트의 렌더링은, 렌더단계와 커밋 단계로 나뉜다.

## 2.4.4 렌더와 커밋

### 렌더 단계 (Render Phase)

- 컴포넌트를 렌더링하고 변경 사항을 계산하는 모든 작업
- 컴포넌트를 실행(render) 하여 이 결과와 이전 가상 DOM을 비교
  - 변경이 필요한 컴포넌트를 체크
- 비교 하는 것들
  - `type`
  - `props`
  - `key`

### 커밋 단계 (Commit Phase)

- 렌더 단계의 변경 사항을 실제 DOM에 적용해 사용자에게 보여주는 과정
  - 커밋 단계의 DOM을 노드 및 인스턴스를 가리키도록 내부의 참조를 업데이트한다.
    - 클래스 컴포넌트 : componentDidMount, componentDidUpdate 호출
    - 함수 컴포넌트 : useLayoutEffect hook 호출

> 리액트의 렌더링이 일어난다고 해서 무조건 DOM 업데이트가 일어나는 것은 아니다.

- 변경 사항 계산결과, 변경사항이 감지되지 않는다면, 커밋 단계는 생략될 수 있다.
  - 가시적인 변경이 일어나지 않아도 리액트 렌더링은 발생할 수 있다.

## 2.4.5 일반적인 렌더링 시나리오 살펴보기

- 컴포넌트를 렌더링하는 작업은 모든 하위 컴포넌트에 영향을 미친다.
  - 별도의 렌더링을 피하기 위한 조치를 취하지 않는다면 무조건 일어난다.
- 부모가 변경됐다면 props가 변경됐는지 상관없이 무조건 자식 컴포넌트도 리렌더링 된다.
